# PDFShift 需求文档补充 (Supplement)

**版本**: 1.0
**日期**: 2026-02-19

本文档补充原 requirements.md 中缺失的需求内容。

---

## 10. 移动端适配 (Mobile Responsiveness)

### 10.1 响应式断点

| 设备类型 | 屏幕宽度 | 布局调整 |
|---------|---------|---------|
| **手机 (竖屏)** | < 768px | 单栏布局，隐藏侧边广告，功能按钮纵向排列 |
| **平板 (竖屏)** | 768px - 1024px | 两栏布局，保留一侧广告，功能按钮适当缩小 |
| **平板 (横屏) / PC** | > 1024px | 三栏布局（左广告-功能区-右广告），完整功能展示 |

### 10.2 移动端交互优化

- **文件上传**：
  - 支持调用相机拍摄文档（使用 HTML5 `capture` 属性）。
  - 支持从相册选择文件。
  - 增大点击区域（按钮最小 44×44px）。

- **进度显示**：
  - 移动端使用全屏半透明遮罩显示进度，避免误操作。
  - 增加"后台处理"选项，允许用户离开页面后继续转换。

- **下载优化**：
  - 移动端支持直接分享到其他应用（WhatsApp、微信等）。
  - 提供"发送到邮箱"功能，避免下载后找不到文件。

### 10.3 性能优化

- **图片懒加载**：广告位图片延迟加载。
- **代码分割**：移动端仅加载必要组件，减少首屏加载时间。
- **PWA 支持**（可选）：添加到主屏幕，提供类原生应用体验。

---

## 11. 广告位详细规范 (Advertisement Specification)

### 11.1 广告位布局

```
┌───────────────────────────────────────────────────┐
│  ┌───────┐       ┌─────────────┐       ┌───────┐ │
│  │ 左侧  │       │   核心功能   │       │ 右侧  │ │
│  │ 广告  │       │    操作区    │       │ 广告  │ │
│  │ 160×600│      │             │       │ 160×600│ │
│  └───────┘       └─────────────┘       └───────┘ │
│                                                   │
│  ┌─────────────────────────────────────────────┐ │
│  │          底部广告 (728×90 或 320×50)         │ │
│  └─────────────────────────────────────────────┘ │
└───────────────────────────────────────────────────┘
```

### 11.2 广告尺寸规格

| 位置 | 桌面端尺寸 | 移动端尺寸 | 广告联盟格式 |
|------|-----------|-----------|-------------|
| **左侧栏** | 160×600px | 隐藏 | Google AdSense 宽幅摩天大楼 |
| **右侧栏** | 160×600px | 隐藏 | Google AdSense 宽幅摩天大楼 |
| **顶部横幅** | 728×90px | 320×50px | Google AdSense 横幅广告 |
| **底部横幅** | 728×90px | 320×100px | Google AdSense 横幅广告 |

### 11.3 广告展示策略

- **加载时机**：页面加载完成后 1 秒才加载广告脚本，避免影响核心功能。
- **反作弊**：使用 Cloudflare Turnstile 验证，防止机器人刷广告展示。
- **用户体验**：
  - 广告不得覆盖核心功能区。
  - 禁止自动播放音视频广告。
  - 移动端折叠侧边广告，仅保留顶部/底部横幅。
- **收益优化**：
  - 对付费用户可提供"无广告版本"选项（额外收费）。
  - 监控广告点击率 (CTR)，定期调整广告位布局。

---

## 12. 通知与反馈机制 (Notification & Feedback)

### 12.1 邮件通知

**触发场景**：
- 付费文件转换完成后，发送下载链接到用户邮箱。
- 付费失败或退款时，发送通知邮件。

**邮件内容示例**：
```
主题：您的文件转换已完成 - PDFShift

尊敬的用户，

您的文件 "report.pdf" 已成功转换为 Word 文档。

下载链接：https://coreshift.cn/download/abc123
（有效期：24小时）

如有问题，请回复此邮件或访问帮助中心。

---
PDFShift 团队
```

**实现方式**：
- 使用 **阿里云邮件推送服务** 或 **SendGrid**。
- 数据库添加 `user_email` 字段（可选填）。

### 12.2 用户反馈系统

**功能入口**：
- 页面底部"问题反馈"按钮。
- 转换失败页面自动弹出"反馈"表单。

**反馈表单字段**：
- 问题类型（下拉选择）：转换失败、结果不满意、支付问题、其他。
- 详细描述（文本框，必填）。
- 上传截图（可选）。
- 联系邮箱（可选，用于回复）。

**后台处理**：
- 反馈内容存储到数据库表 `feedbacks`。
- 管理后台提供"反馈管理"模块，支持标记已处理/未处理。
- 重要问题自动发送邮件通知管理员。

---

## 13. SEO 优化需求 (SEO Optimization)

### 13.1 基础 SEO

**页面标题与描述**：
```html
<!-- 首页 -->
<title>PDFShift - 免费 PDF 在线转换工具 | PDF转Word、Excel、PPT</title>
<meta name="description" content="PDFShift 提供免费在线 PDF 转换服务，支持 PDF 转 Word、Excel、PPT，以及 PDF 拆分、合并功能。保护隐私，文件 2 小时后自动删除。">
<meta name="keywords" content="PDF转Word, PDF转Excel, PDF转PPT, PDF合并, PDF拆分, 在线PDF工具">

<!-- Open Graph (社交分享) -->
<meta property="og:title" content="PDFShift - 在线 PDF 转换工具">
<meta property="og:description" content="免费转换 PDF 文件，支持 Word、Excel、PPT 格式。">
<meta property="og:image" content="https://coreshift.cn/og-image.png">
<meta property="og:url" content="https://coreshift.cn">
```

**结构化数据** (JSON-LD):
```json
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "PDFShift",
  "description": "在线 PDF 转换工具",
  "url": "https://coreshift.cn",
  "applicationCategory": "UtilityApplication",
  "operatingSystem": "Any",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "CNY"
  }
}
```

### 13.2 技术 SEO

- **Sitemap.xml**：生成并提交到 Google Search Console 和百度站长工具。
- **Robots.txt**：允许搜索引擎抓取主页和功能页，禁止抓取 `/api/` 和 `/admin/`。
- **页面加载速度**：
  - 使用 CDN 加速静态资源。
  - 图片压缩和 WebP 格式支持。
  - 启用 Gzip/Brotli 压缩。
  - 首屏渲染时间 < 2 秒。
- **移动友好**：通过 Google Mobile-Friendly Test。
- **HTTPS**：全站强制 HTTPS，配置 HSTS 头。

### 13.3 内容营销

- **博客/帮助中心**（可选）：
  - 发布 PDF 处理技巧文章（如"如何压缩 PDF 文件大小"）。
  - 提高网站权重和自然流量。
- **长尾关键词优化**：
  - 针对"PDF 转 Word 免费在线"、"PDF 合并工具"等长尾词优化内容。

---

## 14. 国际化支持 (Internationalization)

### 14.1 语言支持

**初期支持语言**：
- 简体中文 (zh-CN) - 默认语言
- 英文 (en-US) - 国际版

**实现方式**：
- 前端使用 `react-i18next` 或 `vue-i18n`。
- 后端 API 响应根据 `Accept-Language` 头返回对应语言的错误信息。

**语言切换入口**：
- 页面右上角语言切换按钮（地球图标 + 下拉菜单）。
- 根据浏览器语言自动选择默认语言。

### 14.2 本地化需求

- **货币**：支持人民币 (¥) 和美元 ($)。
- **日期格式**：
  - 中文：`2026年2月19日`
  - 英文：`Feb 19, 2026`
- **文件大小单位**：国际通用 (MB, GB)。

### 14.3 内容翻译

| 中文 | English |
|------|---------|
| PDF 转 Word | PDF to Word |
| 上传文件 | Upload File |
| 转换中... | Converting... |
| 下载结果 | Download Result |
| 文件过大，请付费解锁 | File too large, please upgrade |
| 文件已过期 | File has expired |

---

## 15. 用户协议与隐私政策 (Terms & Privacy)

### 15.1 用户协议要点

- **服务范围**：提供 PDF 在线处理服务，不保证 100% 转换准确度。
- **文件隐私**：
  - 免费文件 1 小时后自动物理删除。
  - 付费文件 24 小时后删除。
  - 不对用户文件内容进行审核或存储超过承诺时间。
- **免责声明**：
  - 用户对上传文件的合法性负责。
  - 不负责文件内容侵权、涉密等法律责任。
- **禁止行为**：
  - 恶意上传大量无效文件。
  - 使用爬虫或自动化工具滥用服务。
  - 上传违法违规内容。

### 15.2 隐私政策要点

- **数据收集**：
  - 自动收集：IP 地址、浏览器指纹、操作日志。
  - 用户提供：邮箱地址（可选）。
- **数据用途**：
  - 提供和改进服务。
  - 防止滥用和欺诈。
  - 发送转换完成通知（如提供邮箱）。
- **数据保护**：
  - 采用 HTTPS 加密传输。
  - 文件存储在加密的 OSS 中。
  - 不出售或共享用户数据给第三方。
- **Cookie 使用**：
  - 使用 Cookie 识别用户身份（Client_ID）。
  - 用户可通过浏览器设置拒绝 Cookie，但可能影响服务使用。

### 15.3 页面展示

- 页面底部增加链接：
  ```html
  <footer>
    <a href="/terms">用户协议</a> |
    <a href="/privacy">隐私政策</a> |
    <a href="/contact">联系我们</a> |
    <a href="/help">帮助中心</a>
  </footer>
  ```

---

## 16. 数据报表完整列表 (Admin Dashboard Reports)

### 16.1 用户统计

- **每日活跃用户 (DAU)**：按日期统计独立 Client_ID 数量。
- **每月活跃用户 (MAU)**：按月统计独立 Client_ID 数量。
- **新增用户**：首次访问的 Client_ID 数量。
- **用户留存率**：7 日留存、30 日留存。

### 16.2 转换统计

- **总转换次数**：按日期、任务类型统计。
- **转换成功率**：`completed / (completed + failed)` 百分比。
- **平均处理时间**：从任务提交到完成的平均耗时。
- **失败原因分析**：按 `error_msg` 分组统计（如"文件加密"、"文件损坏"）。

### 16.3 收入统计

- **每日收入**：按日期统计 `orders` 表中 `status='paid'` 的订单金额总和。
- **付费转化率**：`付费订单数 / 总任务数`。
- **平均客单价**：`总收入 / 付费订单数`。
- **退款率**：`退款订单数 / 付费订单数`。

### 16.4 系统性能

- **服务器资源**：CPU、内存、磁盘使用率（从阿里云监控 API 获取）。
- **任务队列长度**：当前 Redis 队列中待处理任务数。
- **API 响应时间**：P50、P95、P99 响应时间分布。
- **错误率**：5xx 错误占比。

### 16.5 存储统计

- **OSS 存储用量**：当前 Bucket 总大小。
- **OSS 下行流量**：按日期统计文件下载流量。
- **文件过期清理**：每日自动清理的文件数量和释放的空间。

---

## 17. 测试与质量保证 (Testing & QA)

### 17.1 测试范围

| 测试类型 | 测试内容 | 执行频率 |
|---------|---------|---------|
| **功能测试** | 上传、转换、下载、支付全流程 | 每次发布前 |
| **兼容性测试** | Chrome, Firefox, Safari, Edge 最新版本 + 移动端 | 每次发布前 |
| **性能测试** | 模拟 1000 并发用户，测试系统响应时间 | 每月 1 次 |
| **安全测试** | SQL 注入、XSS、CSRF 漏洞扫描 | 每季度 1 次 |
| **压力测试** | 测试系统最大承载能力 | 上线前 + 每季度 1 次 |

### 17.2 测试用例示例

**场景 1：免费用户上传 30MB 文件转换为 Word**
- 预期结果：转换成功，1 小时后文件自动删除。

**场景 2：用户上传 80MB 文件，选择预览模式**
- 预期结果：仅转换前 10 页，添加水印，无需付费。

**场景 3：用户上传加密 PDF**
- 预期结果：提示"文件已加密，请输入密码"，或提示"无法处理加密文件"。

**场景 4：用户支付后转换失败**
- 预期结果：自动退款，更新订单状态为 `refunded`。

### 17.3 验收标准

- **功能完整性**：所有需求功能正常运行，无阻塞性 Bug。
- **性能指标**：
  - API 响应时间 < 500ms (P95)。
  - 页面首屏加载时间 < 2 秒。
  - 转换 50MB PDF 平均耗时 < 30 秒。
- **安全性**：通过 OWASP Top 10 漏洞扫描。
- **兼容性**：主流浏览器无布局错乱或功能异常。

---

## 18. 部署与发布流程 (Deployment & Release)

### 18.1 发布流程

```
开发完成
    ↓
代码审查 (Code Review)
    ↓
单元测试 + 集成测试
    ↓
提交到 main 分支
    ↓
触发 GitHub Actions
    ↓
自动构建前端 + 后端镜像
    ↓
部署到 ECS 服务器
    ↓
健康检查
    ↓ 通过
发布完成，通知团队
    ↓ 失败
自动回滚到上一版本
```

### 18.2 发布检查清单

**发布前**：
- [ ] 所有测试用例通过
- [ ] 数据库迁移脚本准备就绪
- [ ] `.env` 环境变量检查
- [ ] 备份当前运行版本
- [ ] 通知相关人员发布计划

**发布中**：
- [ ] 监控 GitHub Actions 执行状态
- [ ] 检查健康检查接口
- [ ] 查看容器日志

**发布后**：
- [ ] 手动测试核心功能（上传、转换、下载）
- [ ] 检查监控指标（CPU、内存、错误率）
- [ ] 验证管理后台可访问
- [ ] 更新发布日志

### 18.3 回滚策略

**触发条件**：
- 健康检查失败
- 错误率 > 5%
- 核心功能不可用

**回滚步骤**：
```bash
# 停止当前版本
sudo docker-compose down

# 恢复备份版本
sudo cp -r /opt/pdfshift.backup.last /opt/pdfshift

# 重启服务
cd /opt/pdfshift
sudo docker-compose up -d
```

---

## 19. 运营与增长策略 (Growth Strategy)

### 19.1 推广渠道

- **SEO 优化**：针对"PDF 转 Word 在线"等关键词优化内容。
- **社交媒体**：在微博、知乎、Reddit 发布工具介绍和使用技巧。
- **内容营销**：撰写"PDF 处理技巧"博客文章，吸引自然流量。
- **合作推广**：与办公软件、在线教育平台合作推广。
- **广告投放**（可选）：Google Ads、百度推广，按点击付费 (CPC)。

### 19.2 用户增长指标

| 指标 | 目标值 (首年) | 说明 |
|------|-------------|------|
| **月访问量 (PV)** | 1,000 → 10,000 | 初期 1000，逐月增长 |
| **注册用户** | 500 | 可选注册功能 |
| **付费转化率** | 3% | 免费用户转付费用户 |
| **用户留存率 (30天)** | > 20% | 30 天内再次使用的用户占比 |

### 19.3 付费策略

- **免费增值模式 (Freemium)**：
  - 免费：< 50MB 文件。
  - 付费：50MB - 500MB 文件，按次收费（如 ¥5/次）。
- **会员订阅**（可选，后期引入）：
  - 月度会员：¥29/月，无限次转换，无广告。
  - 年度会员：¥199/年，享受折扣。
- **企业定制**：为企业客户提供 API 接口或私有部署服务。

---

## 20. 风险与应对措施 (Risks & Mitigation)

### 20.1 技术风险

| 风险 | 影响 | 应对措施 |
|------|------|---------|
| **服务器宕机** | 服务不可用 | 配置阿里云监控告警，快速响应 |
| **OSS 故障** | 文件无法上传/下载 | 备用 OSS Bucket，或临时切换到本地存储 |
| **转换失败率高** | 用户体验差 | 持续优化转换库，增加异常处理 |
| **数据库连接耗尽** | API 请求失败 | 增加连接池大小，启用连接复用 |

### 20.2 安全风险

| 风险 | 影响 | 应对措施 |
|------|------|---------|
| **DDoS 攻击** | 服务不可用 | 启用阿里云 DDoS 防护 |
| **恶意上传大文件** | 资源耗尽 | 限制单文件大小，启用速率限制 |
| **数据泄露** | 用户隐私受损 | 全站 HTTPS，数据库加密，定期安全审计 |
| **支付欺诈** | 经济损失 | 对接支付平台风控系统，异常订单人工审核 |

### 20.3 业务风险

| 风险 | 影响 | 应对措施 |
|------|------|---------|
| **版权纠纷** | 法律风险 | 用户协议声明，不审核文件内容 |
| **竞争对手** | 用户流失 | 差异化功能（如更好的排版还原），优化用户体验 |
| **运营成本超预期** | 亏损 | 监控 OSS 流量，优化文件存储策略 |

---

**需求文档补充完成**。所有缺失的章节已补全，涵盖移动端、广告、通知、SEO、国际化、测试、部署、运营等方面。
